import * as actionTypes from './actions';
import bankValidator from "nz-bank-account-validator/lib/NZ-Bank-Account-Validator";

const initialState = {
    bank: null,
    bankBank: '',
    bankBranch: '',
    bankAccount: '',
    bankSuffix: '',
    swift: null,
    isValidBankAccount: false
};

const accountEntered = (state, action) => {
    let bankMapping  = {
        '01': { name: 'ANZ',                                        address: 'ANZ Bank New Zealand Ltd, Floor 10, 170-186 Featherston St, Wellington 6011, New Zealand' },
        '02': { name: 'BNZ',                                        address: 'Bank of New Zealand, Wellington, New Zealand' }, // Can also be "The Co-operative Bank" worry about this later
        '03': { name: 'Westpac',                                    address: 'Westpac New Zealand Limited, Auckland, New Zealand' }, // Can also be NZ credit union/Rabobank
        '06': { name: 'National Bank of New Zealand',               address: '[TODO]' }, // ?? Defunct??
        '08': { name: 'National Australia Bank',                    address: '[TODO]' }, // ??? Who is this ?
        '10': { name: 'Industrial and Commercial Bank of China',    address: 'Industrial and Commercial Bank of China Ltd, Level 22/188 Quay St, Auckland 1142, New Zealand' },
        '12': { name: 'ASB',                                        address: 'ASB Bank Limited, 12 Jellicoe Street, Auckland Central, Auckland 1010, New Zealand'},
        '15': { name: 'TSB',                                        address: 'TSB Centre, 120 Devon St East, New Plymouth 4310, New Zealand' },
        '30': { name: 'HSBC',                                       address: 'The Hongkong and Shanghai Banking Corporation Limited, HSBC House, Level 9, 1 Queen Street, Auckland, New Zealand' },
        '31': { name: 'Citibank',                                   address: 'CitiBank, Level 7/23 Customs St E, Auckland 1010, New Zealand' },
        '38': { name: 'Kiwibank',                                   address: 'Kiwibank Limited, Ground Floor, New Zealand Post House, 7 Waterloo Quay, Wellington 6011, New Zealand' }
    };

    let swiftMapping = {
        '01': 'ANZBNZ22', // ANZ https://help.anz.co.nz/app/answers/detail/a_id/367/~/swift-code%2Fbic-code'
        '02': 'BKNZNZ22', // BNZ https://www.bnz.co.nz/business-banking/support/international/incoming-international-payments
        '03': 'WPACNZ2W', // Westpac http://westpac.custhelp.com/app/answers/detail/a_id/25
        '10': 'ICBKNZ2A', // Industrial and Commercial Bank of China ?????? Got it from https://www.theswiftcodes.com/new-zealand/icbknz2a/
        '12': 'ASBBNZ2A', // ASB https://www.asb.co.nz/help/overseas-bank-funds.html
        '15': 'TSBANZ22', // TSB https://www.tsb.co.nz/foreign-exchange/transfer-from-overseas
        '30': 'HSBCNZ2A', // HSBC ??? https://www.theswiftcodes.com/new-zealand/hsbcnz2a/
        '31': 'CITINZ2X', // Citibank ???? https://www.theswiftcodes.com/new-zealand/citinz2x/
        '38': 'KIWINZ22' // Kiwibank https://www.kiwibank.co.nz/personal-banking/international-services/receiving/international-transfers/
    };
    const bankNumber = `${action.accountNumber.bank}-${action.accountNumber.branch}-${action.accountNumber.account}-${action.accountNumber.suffix}`;

    return {
        ...state,
        bank: bankMapping[action.accountNumber.bank],
        bankBank: action.accountNumber.bank,
        bankBranch: action.accountNumber.branch,
        bankAccount: action.accountNumber.account,
        bankSuffix: action.accountNumber.suffix,
        swift: swiftMapping[action.accountNumber.bank],
        isValidBankAccount: bankValidator.validate(bankNumber)
    };
};

const reducer = (state = initialState, action) => {
    switch (action.type) {
        case actionTypes.ACCOUNT_ENTERED:
            return accountEntered(state,  action);
        default:
            return state;
    }
};

export default reducer;